# -*- coding: utf-8 -*-
"""Fix feishu_service.py syntax errors"""

with open('app/services/feishu_service.py', 'r', encoding='utf-8') as f:
    content = f.read()

# Fix 1: Line 588 - missing closing quote
content = content.replace(
    '"ğŸ” å·²åˆ‡æ¢è‡³å…³é”®è¯æ£€ç´¢æ¨¡å¼, "tag"',
    '"ğŸ” å·²åˆ‡æ¢è‡³å…³é”®è¯æ£€ç´¢æ¨¡å¼", "tag"'
)

# Fix 2: Line 656 - update report mode card
old_report_card = '"content": "æ‚¨ç°åœ¨å¤„äº**æ—¥æŠ¥å‘¨æŠ¥æ€»ç»“æ¨¡å¼**ã€‚\\n\\næ‚¨å¯ä»¥ï¼š\\n1. **å‘é€å·¥ä½œå†…å®¹**ï¼ˆå¦‚"ä»Šå¤©å®Œæˆäº†...æ˜å¤©è®¡åˆ’..."ï¼‰ï¼Œæˆ‘å°†ä¸ºæ‚¨ç”Ÿæˆä¸“ä¸šæ—¥æŠ¥ã€‚\\n2. **æŸ¥è¯¢å†å²æ±‡æŠ¥**ï¼ˆå¦‚"æŸ¥è¯¢æ˜¨å¤©çš„æ—¥æŠ¥"ï¼‰ï¼Œæˆ‘å°†ä¸ºæ‚¨æŸ¥æ‰¾å›¢é˜Ÿè®°å½•ã€‚\\n3. **å‘¨åº¦é€’å½’æ€»ç»“**ï¼ˆå‘é€"å‘¨æ€»ç»“"æˆ–"ä¸Šå‘¨æ€»ç»“"ï¼‰ï¼Œåˆ†æä¸€å‘¨è®¡åˆ’å®Œæˆåº¦å¹¶è¯„åˆ†ï¿½?,'
new_report_card = '"content": "æ‚¨ç°åœ¨å¤„äº**æ—¥æŠ¥å‘¨æŠ¥æ€»ç»“æ¨¡å¼**ã€‚\\n\\næ‚¨å¯ä»¥ï¼š\\n1. **å‘é€å·¥ä½œå†…å®¹**ï¼ˆå¦‚"ä»Šå¤©å®Œæˆäº†...æ˜å¤©è®¡åˆ’..."ï¼‰ï¼Œæˆ‘å°†ä¸ºæ‚¨ç”Ÿæˆä¸“ä¸šæ—¥æŠ¥ã€‚\\n2. **æŸ¥è¯¢å†å²æ±‡æŠ¥**ï¼ˆå¦‚"æŸ¥è¯¢æ˜¨å¤©çš„æ—¥æŠ¥"ï¼‰ï¼Œæˆ‘å°†ä¸ºæ‚¨æŸ¥æ‰¾å›¢é˜Ÿè®°å½•ã€‚\\n3. **ç”Ÿæˆæ€»ç»“æŠ¥å‘Š**ï¼Œç¤ºä¾‹ï¼š\\n   - ğŸ“… æ—¥æ€»ç»“ï¼š"02-09æ€»ç»“"ã€"æ˜¨å¤©æ€»ç»“"\\n   - ğŸ“Š å‘¨æ€»ç»“ï¼š"æœ¬å‘¨æ€»ç»“"ã€"ä¸Šå‘¨æ€»ç»“"\\n   - ğŸ“ˆ æœˆæ€»ç»“ï¼š"1æœˆæ€»ç»“"ã€"ä¸Šæœˆæ€»ç»“",'

content = content.replace(old_report_card, new_report_card)

# Fix 3 & 4: Lines 733, 747 - corrupted emoji
content = content.replace('f"**ï¿½?åŸå§‹æç¤ºï¿½?*', 'f"**âœ¨ åŸå§‹æç¤ºè¯**')
content = content.replace('f"**ï¿½?ä¼˜åŒ–ç»“æœ**', 'f"**âœ¨ ä¼˜åŒ–ç»“æœ**')

# Fix 5: Line 934 - missing closing quote
content = content.replace(
    '"ğŸ¤” éœ€è¦æ‚¨è¡¥å……ä¸€ç‚¹ç»†èŠ‚, "tag"',
    '"ğŸ¤” éœ€è¦æ‚¨è¡¥å……ä¸€ç‚¹ç»†èŠ‚", "tag"'
)

with open('app/services/feishu_service.py', 'w', encoding='utf-8') as f:
    f.write(content)

print('âœ… All fixes applied!')
